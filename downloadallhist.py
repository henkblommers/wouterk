import sys
import re
import mmap
from urllib.request import urlopen
import argparse
import datetime
import csv
import pandas as pd
import io
import numpy

#initial paramaters, which coindata to be dowloaded for whiwh period of time
cryptos = ['Bitcoin','Ethereum','Ripple','Bitcoin-Cash','Litecoin','NEM','NEO'] #,'Cardano','Stellar','EOS','IOTA','Dash','Monero','TRON','Bitcoin-Gold','ICON','Qtum','Ethereum-Classic','Lisk','nano','VeChain','OmiseGO','Tether','Populous','Zcash','Verge','Siacoin','Binance-Coin','Stratis','Bytecoin-bcn','Steem','Ardor','Status','Maker','Augur','BitShares','KuCoin-Shares','0x','Waves','Dogecoin','Electroneum','Veritaseum','Walton','Komodo','Dragonchain','Decred','Dentacoin','Loopring','SALT','QASH','DigiByte','Basic-Attention-token','Golem','Hshare','Kyber-Network','Gas','Ethos','SmartCash','PIVX','Byteball','WAX','FunFair','RChain','Aion','ZClassic','Factom','Dent','MonaCoin','Power-Ledger','Kin','DigixDAO','aelf','Aeternity','Bytom','ReddCoin','Nebulas-token','Syscoin','Enigma','Request-Network','Emercoin','Nexus','ChainLink','Neblio','ZCoin','MaidSafeCoin','Substratum','Experience-points','Bitcore','GXShares','Nxt','Bancor','Cindicator','MediBloc','Cryptonex','Quantstamp','Gnosis','PACcoin','Particl','Iconomi','TenX','GameCredits','BitcoinDark','Civic','Pillar','DigitalNote','SIRIN-LABS-Token','Skycoin','Raiden-Network-token','Poet','SophiaTX','BLOCKv','Vertcoin','DEW','Storj','BridgeCoin','Santiment','VIBE','RLC','Cobinhood','Ubiq','NAV-Coin','BitConnect','Telcoin','Blocknet','PayPie','XTRABYTES','Time-New-Bank','ETHLend','Monaco','Achain','Dynamic-Trading-rights','Simple-Token','Storm','SingularDTV','Enjin-Coin','Red-Pulse','AirSwap','Revain','INS-Ecosystem','DeepBrain-Chain','high-performance-blockchain','AppCoins','Counterparty','WaBi','Peercoin','Edgeless','Ripio-Credit-network','Bibox-Token','BitBay','HTML-COIN','Einsteinium','SONM','SpankChain','Aragon','IoT-Chain','Decentraland','Melon','Amber','CyberMiles','Internet-Node-token','Quantum-resistant-ledger','AdEx','ZenCash','attention-token-of-media','Streamr-DATAcoin','Modum','NAGA','Gulden','UTRUST','Centra','MediShares','district0x','Metal','SuperNET','ION','Nuls','Rise','Electra','Etherparty','library-credit','Unikoin-Gold','Viacoin','Triggers','Metaverse','CloakCoin','Agoras-Tokens','QLINK','Wings','IOCoin','MobileGo','Wagerr','Oyster','Burst','HempCoin','SaluS','Asch','Bread','Eidoo','Tierion','Decision-Token','Lamden','DECENT','Hive','CoinDash','Lunyr','FirstBlood','Aeon','Grid','Voxels','Genesis-Vision','ECCoin','HelloGold','Groestlcoin','Lykke','MinexCoin','safe-exchange-coin','Gifto','Mooncoin','BitClave','TokenCard','Cofound-it','Dimecoin','Shift','Mercury','TaaS','Namecoin','Trust','Everex','Agrello-delta','Presearch','Crown','Pura','Ink','Monetha','Feathercoin','SHIELD','Trade-Token','Pepe-Cash','Worldcore','adToken','Viberate','Flash','Jinn','Spectrecoin','Voise','iXledger','bitCNY','YOYOW','Neumark','Paypex','EncrypGen', 'janus','electroneum','sirin-labs-token','simple-token','bottos']
#1200 rest not checked ,'Bloom','LAToken','PotCoin','Delphy','Humaniq','Matchpool','Datum','Mothership','Pascal-Coin','Blocktix','Nimiq','Steem-Dollars','FairCoin','Moeda-Loyalty-points','Diamond','NuShares','Elastic','Snovio','Aurora-DAO','SolarCoin','SIBCoin','Divi','DeepOnion','Synereo','BlackCoin','VeriCoin','Peerplays','Game.com','COSS','SunContract','WhiteCoin','DomRaider','Ormeus-Coin','Expanse','BlockMason','Zeusshield','Stox','Xenon','NoLimitCoin','Propy','Bounty0x','Myriad','GridCoin','Aeron','Bodhi','NewYorkCoin','AirToken','Maecenas','Phore','Rivetz','Numeraire','OKCash','NVO','ALIS','Radium','Omni','Pandacoin','Neutron','MonetaryUnit','Golos','ATBCoin','LEOcoin','Rubycoin','Bismuth','DecentBet','Mintcoin','LUXCoin','Blackmoon','NeosCoin','Bean-Cash','LIFE','Zoin','Nexium','PoSW-Coin','DubaiCoin','OAX','ClearPoll','open-trading-network','Credo','Target-Coin','BLUE','eBitcoin','InvestFeed','FlorinCoin','ColossusCoinXT','Paragon','OracleChain','Linda','Unobtanium','Chronobank','BlockCAT','Publica','KickCoin','Hush','Rialto','Databits','MyBit-Token','Patientory','Dovu','Elixir','Playkey','Swarm City','Hedge','Aigang','Oxycoin','Soarcoin','Waves Communi...','LoMoCoin','Bitcrystals','Incent','Solaris','Energycoin','Polis','Monoeci','Payfair','Sequence','Obsidian','Primecoin','ICOS','Polybius','FoldingCoin','SportyFi','Circuits of V...','Clams','Xaurum','Gambit','QunQun','BitSend','HEAT','Global Curren...','LockChain','Musicoin','bitUSD','GoByte','onG.social','Autonio','Verify','Flixxo','Etheroll','FirstCoin','Sphere','Primas','bitqy','RussiaCoin','Curecoin','Aventus','Sumokoin','Mysterium','Stealthcoin','Boolberry','ArtByte','Quantum','Pluton','AsiaCoin','Russian Miner...','GeoCoin','BitDice','Espers','Change','Internet-of-People','DAO-Casino','PinkCoin','Pirl','Vsync','OneRoot-Network','Mercury-Protocol','Exchange Union','Universal Cur...','Social Send','BitBoost','ProChain','CVCoin','Uquid-Coin','OBITS','ALQO','Syndicate','Astro','Bulwark','Lampix','AdShares','Innova','Upfiring','Ecobit','Bitcloud','Regalcoin','LendConnect','EarthCoin','FedoraCoin','Hacken','Vcash','KiloCoin','SpreadCoin','E-Dinar Coin','Bitmark','FlypMe','Atmos','BuzzCoin','Bitdeal','Tao','Sprouts','DopeCoin','ATLANT','Memetic / Pep...','CrowdCoin','Wild Crypto','TIES Network','UFO Coin','IntenseCoin','HEROcoin','TrezarCoin','TransferCoin','MyWish','AudioCoin','Bonpay','Qwark','The ChampCoin','Creditbit','REX','Pesetacoin','BitcoinZ','HyperStake','Bitzeny','Altcoin','Dotcoin','E-coin','Auroracoin','Bela','Novacoin','NuBits','DigiPulse','Hubii Network','Blitzcash','Kore','Bitcoin Plus','Synergy','CannabisCoin','MicroMoney','Masternodecoin','ChainCoin','Breakout Stake','VeriumReserve','Magnet','Breakout','B2B','GoldCoin','Blockpool','Crave','Indorse Token','Opus','Internxt','Riecoin','Tokes','XGOX','2GIVE','Dai','Social','TrueFlip','PRIZM','Sharechain','Pylon Network','Creativecoin','HollyWoodCoin','VIVO','ExclusiveCoin','ToaCoin','vTorrent','Project Decorum','Carboncoin','Zero','Farad','DNotes','1337','Privatix','Eroscoin','CryptoPing','DCORP','Bowhead','ZrCoin','EuropeCoin','Sexcoin','ProCurrency','Rupee','Starta','TrustPlus','CHIPS','NobleCoin','Pure','Interstellar ...','Startcoin','Dynamic','Terracoin','GCoin','Qvolta','PutinCoin','EverGreenCoin','vSlice','WorldCoin','REAL','MCAP','Quark','Ixcoin','MarteXcoin','LuckChain','Ellaism','Greencoin','FORCE','Commodity Ad ...','DigitalPrice','Embers','Magi','EquiTrader','eBoost','Kubera Coin','Karbo','Ethereum Movi...','SmartBillions','BlueCoin','Anoncoin','bitJob','e-Gulden','HunterCoin','Footy Cash','Ethbits','WandX','Goodomy','APX','Monkey Project','CarTaxi Token','ParkByte','Condensate','Adelphoi','Yocoin','Zephyr','STRAKS','ELTCOIN','Royal Kingdom...','HOdlcoin','Gimli','Dinastycoin','Denarius','Intelligent T...','FlutterCoin','Moin','Linx','Version','TheGCCcoin','Influxcoin','FLiK','NEVERDIE','Bytecent','Zeitcoin','LiteDoge','Unify','Primalbase Token','Emphy','PopularCoin','ArcticCoin','Cryptonite','Etheriya','DraftCoin','FujiCoin','Bitradio','Adzcoin','Crypto Bullion','Bitcoin Scrypt','Cryptopay','Rustbits','FundYourselfNow','CampusCoin','Megacoin','Renos','Accelerator N...','Scorecoin','TittieCoin','AurumCoin','InsaneCoin','Canada eCoin','Ethereum Cash','Oceanlab','NetCoin','IncaKoin','Legends Room','UnbreakableCoin','Global-Jobcoin','Kolion','AltCommunity ...','Jetcoin','42-coin','Piggycoin','MazaCoin','ICO OpenLedger','Copico','Fastcoin','BunnyCoin','Janus','OP Coin','Halcyon','Abjcoin','TeslaCoin','InflationCoin','Bata','Desire','Unitus','CryptoForecast','Ethereum Gold','ERC20','Steneum Coin','Cream','Tracto','DROXNE','Growers Inter...','Centurion','Machinecoin','KekCoin','CryptoCarbon','Smart Investm...','SmileyCoin','Zetacoin','SagaCoin','MACRON','Bitcurrency','Zennies','Elementrem','GAIA','I0Coin','Digitalcoin','StarCredits','EthBet','iTicoin','Guncoin','SkinCoin','QubitCoin','PureVidz','Orbitcoin','OctoCoin','BritCoin','CoinonatX','BlakeStar','Madcoin','Authorship','Fujinto','Netko','UltraCoin','Woodcoin','BitBar','Eternity','DFSCoin','Deutsche eMark','Ace','FuelCoin','Bitstar','SmartCoin','Trollcoin','Minereum','Billionaire T...','Kobocoin','Octanox','Capricoin','Ammo Reloaded','Visio','BiblePay','Monster Byte','Nyancoin','FUNCoin','Atomic Coin','Fantomcoin','FuckToken','Bitcoin Red','Aricoin','Chronos','HoboNickels','LanaCoin','Bitpark Coin','CryptoInsight','PetroDollar','Titcoin','MaxCoin','DaxxCoin','Kurrent','Nekonium','Bitgem','Sugar Exchange','Coin(O)','iEthereum','StarCash Network','Joulecoin','C-Bit','Cryptojacks','Happycoin','TrumpCoin','Zlancer','Triangles','UniCoin','Confido','Xios','Colossuscoin V2','WavesGo','AmsterdamCoin','GoldBlocks','Crystal Clear ','HitCoin','Giga Watt Token','Motocoin','AdCoin','Prototanium','Opal','PoSToken','Tigercoin','SuperCoin','Dashcoin','Argentum','KushCoin','SwagBucks','PlatinumBAR','Pioneer Coin','Ethereum Dark','DigiCube','Rimbit','Elcoin','PostCoin','Blakecoin','8Bit','Phoenixcoin','CannaCoin','Pakcoin','Dollarcoin','Coin2.1','Advanced Inte...','Bitcoin Fast','HiCoin','RedCoin','WhaleCoin','ChanCoin','LiteBar','Veltor','Bit20','MojoCoin','GoldReserve','RouletteToken','Flycoin','Onix','PayCoin','Sterlingcoin','Ccore','Ratecoin','Unity Ingot','Evil Coin','Aerium','ParallelCoin','Philosopher S...','Hawala.Today','Sovereign Hero','Mineum','ChessCoin','Quatloo','Senderon','ZoZoCoin','Dix Asset','EOT Token','Cypher','DigitalDevelo...','Swing','BitCoal','Mincoin','GlobalBoost-Y','iCoin','Litecoin Plus','Helleniccoin','Darsek','YENTEN','Zurcoin','Gapcoin','Kayicoin','BigUp','Emerald Crypto','Eurocoin','Bolivarcoin','LiteBitcoin','Prime-XI','Hexx','bitBTC','BERNcash','Rupaya','RevolverCoin','Marscoin','Sativacoin','Independent M...','BitAsean','Rubies','GameUnits','VirtualCoin','SoonCoin','Jin Coin','AquariusCoin','Trident Group','Catcoin','Bitcoin Planet','BumbaCoin','SecureCoin','TagCoin','SixEleven','SpaceCoin','eBitcoinCash','Dalecoin','Marijuanacoin','MustangCoin','ReeCoin','BTCtalkcoin','Cannation','Evotion','TEKcoin','CacheCoin','CompuCoin','VoteCoin','808Coin','ICOBID','Flaxscript','BoostCoin','PayCon','BriaCoin','Honey','Network Token','X-Coin','Money','BROTHER','ETHGAS','QuazarCoin','GlobalToken','Gold Pressed ...','Cashcoin','bitGold','BipCoin','SOILcoin','Coinonat','RonPaulCoin','DIBCOIN','Digital Rupees','SongCoin','NevaCoin','Neuro','GPU Coin','GoldPieces','Kronecoin','Creatio','EagleCoin','SproutsExtreme','Rasputin Onli...','Mao Zedong','FuzzBalls','300 Token','Beatcoin','Solarflarecoin','Impact','Enigma','LeaCoin','Allion','Eryllium','ZetaMicron','BenjiRolls','Acoin','Skeincoin','EcoCoin','Comet','USDe','Bolenum','Global-Tour-Coin','ExchangeN','BnrtxCoin','Spots','Debitcoin','Cthulhu Offer...','LiteCoin Ultra','Blackstar','CryptoEscudo','Artex Coin','TajCoin','AllSafe','Luna Coin','iDice','ARbit','Asiadigicoin','VapersCoin','MiloCoin','Ripto Bux','BOAT','Master Swiscoin','WomenCoin','DAPPSTER','Tychocoin','GuccioneCoin','HempCoin','Quebecoin','CryptoWorldX ...','Roofs','SwapToken','Speedcash','PlayerCoin','Shilling','Slevin','JavaScript Token','bitEUR','Litecred','Torcoin','CybCSec','AnarchistsPrime','GeertCoin','Dollar Online','Veros','Vault Coin','JobsCoin','Coupecoin','Steps','Argus','Coimatic 2.0','Credence Coin','Antilitecoin','Coimatic 3.0','KingN Coin','Bitvolt','Project-X','ImpulseCoin','LevoPlus','NodeCoin','CrevaCoin','Rawcoin','Concoin','CaliphCoin','Ulatech','Tristar Coin','EXRNchain','HarmonyCoin','Digital Money...','Ebittree Coin','PizzaCoin','AppleCoin','XPlay','BCAP','EncryptoTel [...','Virtacoin','Arcade Token','Prospectors Gold','Bitswift','Ergo','LeviarCoin','Darcrus','InPay','CryptCoin','FIMKrypto','ShadowCash','CorgiCoin','YashCoin','PiplCoin','Link Platform','Shorty','Ultimate Secu...','Truckcoin','Pascal Lite','Tattoocoin (S...','MetalCoin','Universe','Grimcoin','FinCoin','Signatum','BitTokens','AmberCoin','BlockPay','Casino','Stress','BTSR','Bankcoin','WayGuide','Valorbit','Bitz','PX','GlobalCoin','Firecoin','Virtacoinplus','Newbium','SatoshiMadness','Remicoin','Grantcoin','SecretCoin','eREAL','bitSilver','Joincoin','Virta Unique ...','WMCoin','GBCGoldCoin','Franko','Shadow Token','Yacoin','Sling','CoExistCoin','Freicoin','E4ROW','Theresa May Coin','SACoin','HealthyWormCoin','BitQuark','Jewels','IslaCoin','VectorAI','Pulse','Yellow Token','BillaryCoin','AntiBitcoin','Bitcoin 21','Californium','Dreamcoin','PIECoin','Useless Ether...','Metal Music Coin','VIP Tokens','BeaverCoin','Printerium','Crypto','Iconic','PLNcoin','BowsCoin','MindCoin','PosEx','Destiny','WARP','SocialCoin','PRCoin','Ride My Car','FlavorCoin','Uro','BiosCrypto','Wild Beast Block','Zayedcoin','Unrealcoin','MTMGaming','GameBet Coin','Orlycoin','TAGRcoin','RSGPcoin','Braincoin','iBank','G3N','LetItRide','EGO','PonziCoin','OsmiumCoin','Cabbage','Elysium','Xonecoin','High Voltage','CRTCoin','P7Coin','Sojourn','Zonecoin','Corethum','SydPak','Save and Gain','BioBar','Qibuck Asset','FuturXe','Magnum','AgrolifeCoin','GeyserCoin','CCMiner','Selfiecoin','Digital Credits','Lex4All','CoffeeCoin','BurstOcean','Abncoin','ATMCoin','IOStoken','TopChain','BitcoinX','SwftCoin','Acute Angle C...','Show','Bitcoin Diamond','SelfSell','SingularityNET','Kcash','LightChain','Genaro Network','Bottos','Profile Utili...','Theta Token','Super Bitcoin','SpaceChain','SmartMesh','ChatCoin','Energo','Aidos Kuneen','RealChain','AI Doctor','WaykiChain','Olympus Labs','Viuly','Ignis','FairGame','Selfkey','CanYaCoin','Qbao','Hyper Pay','StarChain','Yee','Titanium Bloc...','Safe Trade Coin','Fargocoin','Lightning Bit...','Tezos (Pre-La...','Mobius','AICHAIN','UG Token','Qube','COMSA [ETH]','Read','ArbitrageCT','Maggie','EtherDelta Token','InsurePal','Hydro Protocol','EchoLink','ShareX','Cappasity','COMSA [XEM]','ugChain','IPChain','Rebellious','United Bitcoin','Content and A...','SegWit2x','Mixin','POLY AI','AWARE','First Bitcoin','Filecoin [Fut...','Coinlancer','BigONE Token','MOAC','EA Coin','Gatcoin','Ethorse','DimonCoin','LLToken','ATN','Measurable Da...','TokenClub','InfChain','Numus','StrongHands','HomeBlockCoin','BitDegree','Bankex','Sphre AIR ','Ignition','InvestDigital','Infinitecoin','DIMCOIN','BOScoin','Swisscoin','SHACoin','TOKYO','TerraNova','BetaCoin','Fonziecoin','WETH','IDEX Membership','Leverj','ClubCoin','Bitair','Cyder','Galactrum','Jingtum Tech','Vezt','BitSerial','Harvest Maste...','B3Coin','Escroco','Tokugawa','HTML5COIN','T-coin','Zap','BT2 [CST]','DavorCoin','Infinity Econ...','GameChain System','Jiyo','StrikeBitClub','Karma','PlusCoin','CFun','United Trader...','Purpose','Golos Gold','CryptopiaFeeS...','Maverick Chain','EDRCoin','RefToken','Nimfamoney','GOLD Reward T...','Suretly','UGAIN','FidentiaX','NEO GOLD','Bitcoin God','Animecoin','BlockCDN','Cloud','TechShares','International...','Kzcash','Elacoin','Spectre.ai Di...','Golfcoin','Hackspace Cap...','ZenGold','TodayCoin','MagicCoin','UR','WeAreSatoshi','Spectre.ai Ut...','PayPeer','Phantomx','Nitro','LiteCoin Gold','GET Protocol','Protean','TurboCoin','Cashme','GAY Money','Bitcedi','Starbase','Birds','SafeCoin','SISA','Magnetcoin','ZSEcoin','SIGMAcoin','Bitcoin Silver','PlexCoin','Bitcoin Atom ...','EventChain','Everus','NumusCash','Tellurion','BestChain','VPNCoin','Musiconomi','MergeCoin','BitSoar','Granite','MSD','iQuant','CORION','India Coin','Francs','iBTC','Antimatter','Peacecoin','Macro','Sharkcoin','Triaconta','High Gain','Akuya Coin','FlappyCoin','FAPcoin','Fazzcoin','DynamicCoin','BTCMoon','XTD Coin','AlpaCoin','Aces','Storjcoin X','President Joh...','Sakuracoin','HODL Bucks','Halloween Coin','EncryptoTel [...','PeepCoin','IrishCoin','Regacoin','RubleBit','Ethereum Lite','President Trump','Blockchain Index','CasinoCoin','Matryx','Rcoin','MarxCoin','Internet of T...','Alphabit','Wi Coin','LandCoin','OX Fina','Cubits','Vulcano','Zilbercoin','GlassCoin','STEX','Opescoin','First Bitcoin...','Hyper TV','Donationcoin','Bitcoin2x','MoneyCoin','DeusCoin','Minex','Wowcoin','Primulon','eGold','UniversalRoya...','Dutch Coin','PinkDog','Rupaya [OLD]','TeraCoin','FireFlyCoin','Chronologic','Bitok','Wink','Avoncoin','Cash Poker Pro','Runners','Tattoocoin (L...','UAHPay','ANRYZE','LinkedCoin','Bitbase','eUSD','The Vegan Ini...','Huncoin','Facecoin','netBit','MobileCash','Bastonet','Swapcoin','UNCoin','Soma','Topaz Coin','Pabyosi Coin ...','Aseancoin','eBIT','Mavro','10M Token','Yescoin','LePen','PrismChain','Pirate Blocks','TeslaCoilCoin','NamoCoin','BitAlphaCoin','Dubstep','BlazerCoin','TrickyCoin','WA-Space','GoldMaxCoin','Cheapcoin','FrankyWillCoin','TheCreed','Karmacoin','Sand Coin','Happy-Creator-coin','Qora','GameLeagueCoin','Dashs','Leek-Coin','eLTC','X2','RichCoin','TeamUp','Natcoin','EggCoin','Operand','PeopleCoin','CyberCoin','Moneta','Omicron','ShellCoin','Bubble','Lazaruscoin','XDE-II','Quotient','LAthaan','RoyalCoin','UtaCoin','KashhCoin','BITFID','PokeCoin','Infinity-Pay','AvatarCoin','Hyper','RHFCoin','Cycling-Coin','DarkLisk','Xaucoin','Axiom','InvisibleCoin','CBD-Crystals','Psilocybin','Faceblock','SnakeEyes','FutCoin','DeltaCredits','SportsCoin','Voyacoin','MMXVI','TopCoin','GoldUnionCoin','Compcoin','WINCOIN','Scry.info','RabbitCoin','OCOW','Global-Business-revolution','9COIN','BT1-[CST]','Farstcoin','ENTCash','KemCredit']
startdate = '20190101'
enddate =   '20200101'
filename = "histcoinsdata5.csv"
df = {}

print("Startdate = ", startdate)
print("Enddate  = ", enddate)
print("Filename = ", filename)
print("Downloading data for ", len(cryptos), " coins:")
 
for i in range(len(cryptos)):
    print(i, " ", cryptos[i])
    #open url for cryptocurrency i, and save if in df[i]
    url = 'https://coinmarketcap.com/currencies/' + cryptos[i] + '/historical-data/?start=' + startdate + '&end=' + enddate
    df[i]= urlopen(url,timeout=60).read()
    urlopen(url,timeout=60).close() 
    df[i]= str(df[i],'utf-8')
    
    if (i == 0):  #make a headerlist for the csv, with all dataset parameternames, and derived parameternames
        header = list(re.findall(r'<th .*>([\w ]+)</th>', re.search(r'<thead>(.*)</thead>', df[i], re.DOTALL).group(1)))
        header.insert(0,'Currency') #add label "currency"
      #  header.insert(0,'Currency')
        header = pd.DataFrame(header).T #before saving the header in csv, we need to transpose and pandaframe this little bitch
        header.to_csv(filename, mode= 'a',index=False, header=False) #write header in csv

    rows = re.findall(r'<tr[^>]*>' + r'\s*<td[^>]*>([^<]+)</td>'*7 + r'\s*</tr>', re.search(r'<tbody>(.*)</tbody>', df[i], re.DOTALL).group(1))
    for j in range(len(rows)):  
        row = list(rows[j])
        row.insert(0,cryptos[i]) # add currency to first element of each row
        rows[j]= tuple (row)     
    df[i]= pd.DataFrame(list(rows))
    df[i].to_csv(filename, mode= 'a',index=False, header=False) #write data in csv
    
print(". Download saved in ", filename)

    
